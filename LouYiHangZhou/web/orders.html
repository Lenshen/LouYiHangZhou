<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title></title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0001, minimum-scale=1.0001, maximum-scale=1.0001, user-scalable=no, minimal-ui">
	<meta name="format-detection" content="telephone=no">
	<link rel="stylesheet" href="assets/css/main.css">
</head>
<body>
	<div id="vue-view" class="page-orders">
		<nav class="bdb-x nav">
			<div :class="{'selected': tabIndex == 1}" @click="tabIndex = 1;">全部订单</div>
			<div :class="{'selected': tabIndex == 2}" @click="tabIndex = 2;">待支付</div>
			<div :class="{'selected': tabIndex == 3}" @click="tabIndex = 3;">待收货</div>
			<div :class="{'selected': tabIndex == 4}" @click="tabIndex = 4;">待评价</div>
		</nav>
		<section class="item" v-for="order in orders">
			<div class="top"><a href="order-detail.html?id={{order.order_id}}" class="fl">订单号：{{order.order_id}}</a><div class="fr">{{order.status}}</div></div>
			<div class="goods" v-if="order.order_goods.length > 0">
				<ul>
					<li class="img" v-for="goods in order.order_goods"><a href="goods-detail.html?id={{goods.goods_id}}"><img src="{{goods.image}}" alt=""></a><span v-if="goods.qty > 0">{{goods.qty}}</span></li>
				</ul>
			</div>
			<div class="buttom">
				<p>共 {{order.order_goods.length}} 件商品&#12288;商品金额：{{order.payment_amount}}<span class="fr">{{order.create_time | substring '10')}}</span></p>
				<div class="bdt-x button">
					<a href="" class="button-black">取消订单</a>
					<a href="" class="button-black">重新下单</a>
					<a href="" class="button-black" v-if="order.status_id == 0">去支付</a>
				</div>
			</div>
		</section>
		<!-- <div ng-repeat="item in items" on-finish-render="ngRepeatFinished">
	    <div>{{item.name}}<div>
		</div> -->
	</div>

	<script src="assets/js/lib/jquery.min.js"></script>
	<script src="assets/js/lib/vue.min.js"></script>
	<script src="assets/js/lib/iscroll.js"></script>
	<script src="assets/js/main.js"></script>
	<script>
		
		var vm = new Vue({
			el: '#vue-view',
			data: {
				tabIndex: 1,
				orders: []

			},
			methods: {
				substring: function(string, num) {
					return string.substring(0, num);
				}
			}
		});


		page.push(function() {
			api.orders(0).done(function(response) {
				if (response.success) {
					vm.orders = response.data;

					vm.$nextTick(function() {
						$('.item').each(function() {
							if (!$(this).find('.goods').get(0)) {
								return;
							}
							var pScroll = new IScroll($(this).find('.goods').get(0), {
								snap: true,
								scrollX: true,
								scrollY: false,
								mouseWheel: true
							});
						});
					});
				}
				else {
					Toast(response.message);
				}
			});
		});

	</script>
</body>
</html>